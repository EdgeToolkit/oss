{% if config.host == 'Windows' %}
#-------------------------------------------------------------------------
#  {{config.runner}} at {{config.name}} of {{bundle.workbench}} [Windows]
#-------------------------------------------------------------------------
[[runners]]
  name = "{{config.name}}/{{bundle.workbench}}/{{config.runner}}"
  url = "{{url}}"
  token = "{{token}}"
  limit = 1
  executor = "shell"
  shell = "powershell"
  builds_dir = "C:/CI/{{bundle.workbench}}/builder/_/builds"
  cache_dir = "C:/CI/{{bundle.workbench}}/builder/_/cache"
  environment = [
    #"LC_ALL=en_US.UTF-8", 
                 "EPM_WORKBENCH={{bundle.workbench}}/builder",                 
                 "CONAN_HOOKS={{config.HOME}}/.epm/.workbench/{{bundle.workbench}}/script/conan_hooks/builder.py"
                 ]
  pre_build_script = "python {{config.HOME}}/.epm/.workbench/{{bundle.workbench}}/script/builder_pre_build.py"
  [runners.custom_build_dir]
  [runners.cache]
    [runners.cache.s3]
    [runners.cache.gcs]
{% endif %}

{% if config.host == 'Linux' %}
#-------------------------------------------------------------------------
#  {{config.runner}} at {{config.name}} of {{bundle.workbench}} [Linux]
#-------------------------------------------------------------------------
[[runners]]
  name = "{{config.name}}/{{bundle.workbench}}/{{config.runner}}"
  url = "{{url}}"
  token = "{{token}}"
  limit = 1  
  executor = "docker"
#  builds_dir = "/tmp/CI/{{bundle.workbench}}/builder/_/builds"
#  cache_dir = "/tmp/CI/{{bundle.workbench}}/builder/_/cache"
  environment = [
    #"LC_ALL=en_US.UTF-8", 
                 "EPM_WORKBENCH={{bundle.workbench}}",
                 "CRYPTOGRAPHY_ALLOW_OPENSSL_102=1",
                 "CONAN_HOOKS=/home/conan/.epm/.workbench/script/conan_hooks/builder.py"
                 ]
  pre_build_script = "python ~/.epm/.workbench/script/builder_pre_build.py"

  [runners.custom_build_dir]
  [runners.cache]
    [runners.cache.s3]
    [runners.cache.gcs]
  [runners.docker]
    tls_verify = false
    image = "epmkit/gcc8"
    privileged = false
    disable_entrypoint_overwrite = false
    oom_kill_disable = false
    disable_cache = false
    pull_policy = "if-not-present"
    volumes = ["/cache", 
#               "/tmp/CI/{{bundle.workbench}}",
               "/tmp/CI:/tmp/CI:rw",
               "{{config.HOME}}/.epm/mirrors.yml:/home/conan/.epm/mirrors.yml",
               "{{config.HOME}}/.epm/.workbench/{{bundle.workbench}}/builder:/home/conan/.epm/.workbench/{{bundle.workbench}}",               
               "{{config.HOME}}/.epm/.workbench/{{bundle.workbench}}/script:/home/conan/.epm/.workbench/script"]
    shm_size = 0

{% endif %}